<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 A List of Heatmaps | ComplexHeatmap Complete Reference</title>
  <meta name="description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 A List of Heatmaps | ComplexHeatmap Complete Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jokergoo.github.io/ComplexHeatmap-reference/book" />
  <meta property="og:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/bookcomplexheatmap-cover.jpg" />
  <meta property="og:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="github-repo" content="jokergoo/ComplexHeatmap-reference" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 A List of Heatmaps | ComplexHeatmap Complete Reference" />
  
  <meta name="twitter:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="twitter:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/bookcomplexheatmap-cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="heatmap-annotations.html"/>
<link rel="next" href="legends.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ComplexHeatmap Complete Reference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#general-design"><i class="fa fa-check"></i><b>1.1</b> General design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-brief-description-of-following-chapters"><i class="fa fa-check"></i><b>1.2</b> A brief description of following chapters</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html"><i class="fa fa-check"></i><b>2</b> A Single Heatmap</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#colors"><i class="fa fa-check"></i><b>2.1</b> Colors</a></li>
<li class="chapter" data-level="2.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-titles"><i class="fa fa-check"></i><b>2.2</b> Titles</a></li>
<li class="chapter" data-level="2.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering"><i class="fa fa-check"></i><b>2.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#distance-methods"><i class="fa fa-check"></i><b>2.3.1</b> Distance methods</a></li>
<li class="chapter" data-level="2.3.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering-methods"><i class="fa fa-check"></i><b>2.3.2</b> Clustering methods</a></li>
<li class="chapter" data-level="2.3.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#render-dendrograms"><i class="fa fa-check"></i><b>2.3.3</b> Render dendrograms</a></li>
<li class="chapter" data-level="2.3.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#reorder-dendrograms"><i class="fa fa-check"></i><b>2.3.4</b> Reorder dendrograms</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#row-and_column_orders"><i class="fa fa-check"></i><b>2.4</b> Set row and column orders</a></li>
<li class="chapter" data-level="2.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-seriation"><i class="fa fa-check"></i><b>2.5</b> Seriation</a></li>
<li class="chapter" data-level="2.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#dimension-names"><i class="fa fa-check"></i><b>2.6</b> Dimension names</a></li>
<li class="chapter" data-level="2.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-split"><i class="fa fa-check"></i><b>2.7</b> Heatmap split</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-kmeans-clustering"><i class="fa fa-check"></i><b>2.7.1</b> Split by k-means clustering</a></li>
<li class="chapter" data-level="2.7.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-categorical-variables"><i class="fa fa-check"></i><b>2.7.2</b> Split by categorical variables</a></li>
<li class="chapter" data-level="2.7.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#spilt-by-dendrogram"><i class="fa fa-check"></i><b>2.7.3</b> Split by dendrogram</a></li>
<li class="chapter" data-level="2.7.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#order-of-slices"><i class="fa fa-check"></i><b>2.7.4</b> Order of slices</a></li>
<li class="chapter" data-level="2.7.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#titles-for-splitting"><i class="fa fa-check"></i><b>2.7.5</b> Titles for splitting</a></li>
<li class="chapter" data-level="2.7.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#graphic-parameters-for-splitting"><i class="fa fa-check"></i><b>2.7.6</b> Graphic parameters for splitting</a></li>
<li class="chapter" data-level="2.7.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#gaps-between-slices"><i class="fa fa-check"></i><b>2.7.7</b> Gaps between slices</a></li>
<li class="chapter" data-level="2.7.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-heatmap-annotations"><i class="fa fa-check"></i><b>2.7.8</b> Split heatmap annotations</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-as-raster-image"><i class="fa fa-check"></i><b>2.8</b> Heatmap as raster image</a></li>
<li class="chapter" data-level="2.9" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#customize-the-heatmap-body"><i class="fa fa-check"></i><b>2.9</b> Customize the heatmap body</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#cell-fun"><i class="fa fa-check"></i><b>2.9.1</b> cell_fun</a></li>
<li class="chapter" data-level="2.9.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#layer-fun"><i class="fa fa-check"></i><b>2.9.2</b> layer_fun</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#size-of-the-heatmap"><i class="fa fa-check"></i><b>2.10</b> Size of the heatmap</a></li>
<li class="chapter" data-level="2.11" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#plot-the-heatmap"><i class="fa fa-check"></i><b>2.11</b> Plot the heatmap</a></li>
<li class="chapter" data-level="2.12" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#get-orders-and-dendrograms-from-heatmap"><i class="fa fa-check"></i><b>2.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="2.13" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#subset-a-heatmap"><i class="fa fa-check"></i><b>2.13</b> Subset a heatmap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html"><i class="fa fa-check"></i><b>3</b> Heatmap Annotations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation"><i class="fa fa-check"></i><b>3.1</b> Simple annotation</a></li>
<li class="chapter" data-level="3.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation-as-an-annotation-function"><i class="fa fa-check"></i><b>3.2</b> Simple annotation as an annotation function</a></li>
<li class="chapter" data-level="3.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#empty-annotation"><i class="fa fa-check"></i><b>3.3</b> Empty annotation</a></li>
<li class="chapter" data-level="3.4" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#block-annotation"><i class="fa fa-check"></i><b>3.4</b> Block annotation</a></li>
<li class="chapter" data-level="3.5" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#image-annotation"><i class="fa fa-check"></i><b>3.5</b> Image annotation</a></li>
<li class="chapter" data-level="3.6" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#points-annotation"><i class="fa fa-check"></i><b>3.6</b> Points annotation</a></li>
<li class="chapter" data-level="3.7" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#lines-annotation"><i class="fa fa-check"></i><b>3.7</b> Lines annotation</a></li>
<li class="chapter" data-level="3.8" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#barplot_annotation"><i class="fa fa-check"></i><b>3.8</b> Barplot annotation</a></li>
<li class="chapter" data-level="3.9" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#box-annotation"><i class="fa fa-check"></i><b>3.9</b> Boxplot annotation</a></li>
<li class="chapter" data-level="3.10" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#histogram-annotation"><i class="fa fa-check"></i><b>3.10</b> Histogram annotation</a></li>
<li class="chapter" data-level="3.11" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#density-annotation"><i class="fa fa-check"></i><b>3.11</b> Density annotation</a></li>
<li class="chapter" data-level="3.12" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#joyplot-annotation"><i class="fa fa-check"></i><b>3.12</b> Joyplot annotation</a></li>
<li class="chapter" data-level="3.13" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#horizon-chart-annotation"><i class="fa fa-check"></i><b>3.13</b> Horizon chart annotation</a></li>
<li class="chapter" data-level="3.14" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#text-annotation"><i class="fa fa-check"></i><b>3.14</b> Text annotation</a></li>
<li class="chapter" data-level="3.15" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#mark-annotation"><i class="fa fa-check"></i><b>3.15</b> Mark annotation</a></li>
<li class="chapter" data-level="3.16" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#summary-annotation"><i class="fa fa-check"></i><b>3.16</b> Summary annotation</a></li>
<li class="chapter" data-level="3.17" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#zoom-annotation"><i class="fa fa-check"></i><b>3.17</b> Zoom/link annotation</a></li>
<li class="chapter" data-level="3.18" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#multiple-annotations"><i class="fa fa-check"></i><b>3.18</b> Multiple annotations</a>
<ul>
<li class="chapter" data-level="3.18.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-general-settings"><i class="fa fa-check"></i><b>3.18.1</b> General settings</a></li>
<li class="chapter" data-level="3.18.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#size-of-annotations"><i class="fa fa-check"></i><b>3.18.2</b> Size of annotations</a></li>
<li class="chapter" data-level="3.18.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#annotation-labels"><i class="fa fa-check"></i><b>3.18.3</b> Annotation labels</a></li>
</ul></li>
<li class="chapter" data-level="3.19" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-utility-function"><i class="fa fa-check"></i><b>3.19</b> Utility functions</a></li>
<li class="chapter" data-level="3.20" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#implement-new-annotation-functions"><i class="fa fa-check"></i><b>3.20</b> Implement new annotation functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html"><i class="fa fa-check"></i><b>4</b> A List of Heatmaps</a>
<ul>
<li class="chapter" data-level="4.1" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#heatmap-list-titles"><i class="fa fa-check"></i><b>4.1</b> Titles</a></li>
<li class="chapter" data-level="4.2" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#size-of-heatmaps"><i class="fa fa-check"></i><b>4.2</b> Size of heatmaps</a></li>
<li class="chapter" data-level="4.3" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#gap-between-heatmaps"><i class="fa fa-check"></i><b>4.3</b> Gap between heatmaps</a></li>
<li class="chapter" data-level="4.4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#automatic-adjustment-to-the-main-heatmap"><i class="fa fa-check"></i><b>4.4</b> Automatic adjustment to the main heatmap</a></li>
<li class="chapter" data-level="4.5" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#control-main-heatmap-in-draw-function"><i class="fa fa-check"></i><b>4.5</b> Control main heatmap in draw() function</a></li>
<li class="chapter" data-level="4.6" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#annotations-as-components-are-adjusted"><i class="fa fa-check"></i><b>4.6</b> Annotations as components are adjusted</a></li>
<li class="chapter" data-level="4.7" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-with-annotations"><i class="fa fa-check"></i><b>4.7</b> Concatenate with annotations</a></li>
<li class="chapter" data-level="4.8" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-only-the-annotations"><i class="fa fa-check"></i><b>4.8</b> Concatenate only the annotations</a></li>
<li class="chapter" data-level="4.9" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#vertical-concatenation"><i class="fa fa-check"></i><b>4.9</b> Vertical concatenation</a></li>
<li class="chapter" data-level="4.10" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#subset-heatmap-list"><i class="fa fa-check"></i><b>4.10</b> Subset the heatmap list</a></li>
<li class="chapter" data-level="4.11" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#plot-the-heamtap-list"><i class="fa fa-check"></i><b>4.11</b> Plot the heatmap list</a></li>
<li class="chapter" data-level="4.12" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#get-orders-and-dendrograms-from-a-list-of-heatmaps"><i class="fa fa-check"></i><b>4.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="4.13" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#change-parameters-globally"><i class="fa fa-check"></i><b>4.13</b> Change parameters globally</a></li>
<li class="chapter" data-level="4.14" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#adjust-blank-space-caused-by-annotations"><i class="fa fa-check"></i><b>4.14</b> Adjust blank space caused by annotations</a></li>
<li class="chapter" data-level="4.15" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#manually-increase-space-around-the-plot"><i class="fa fa-check"></i><b>4.15</b> Manually increase space around the plot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>5</b> Legends</a>
<ul>
<li class="chapter" data-level="5.1" data-path="legends.html"><a href="legends.html#continuous-legends"><i class="fa fa-check"></i><b>5.1</b> Continuous legends</a></li>
<li class="chapter" data-level="5.2" data-path="legends.html"><a href="legends.html#discrete-legends"><i class="fa fa-check"></i><b>5.2</b> Discrete legends</a></li>
<li class="chapter" data-level="5.3" data-path="legends.html"><a href="legends.html#a-list-of-legends"><i class="fa fa-check"></i><b>5.3</b> A list of legends</a></li>
<li class="chapter" data-level="5.4" data-path="legends.html"><a href="legends.html#heatmap-and-annotation-legends"><i class="fa fa-check"></i><b>5.4</b> Heatmap and annotation legends</a></li>
<li class="chapter" data-level="5.5" data-path="legends.html"><a href="legends.html#add-customized-legends"><i class="fa fa-check"></i><b>5.5</b> Add customized legends</a></li>
<li class="chapter" data-level="5.6" data-path="legends.html"><a href="legends.html#the-side-of-legends"><i class="fa fa-check"></i><b>5.6</b> The side of legends</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html"><i class="fa fa-check"></i><b>6</b> Heatmap Decoration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-functions"><i class="fa fa-check"></i><b>6.1</b> Decoration functions</a></li>
<li class="chapter" data-level="6.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-examples"><i class="fa fa-check"></i><b>6.2</b> Examples</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#barplot-for-single-column-heatmap"><i class="fa fa-check"></i><b>6.2.1</b> Barplot for single-column heatmap</a></li>
<li class="chapter" data-level="6.2.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#add-titles-for-row-annotations"><i class="fa fa-check"></i><b>6.2.2</b> Add titles for row annotations</a></li>
<li class="chapter" data-level="6.2.3" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#other-possible-use-of-decorations"><i class="fa fa-check"></i><b>6.2.3</b> Other possible use of decorations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="oncoprint.html"><a href="oncoprint.html"><i class="fa fa-check"></i><b>7</b> OncoPrint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-general-settings"><i class="fa fa-check"></i><b>7.1</b> General settings</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="oncoprint.html"><a href="oncoprint.html#input-data-format"><i class="fa fa-check"></i><b>7.1.1</b> Input data format</a></li>
<li class="chapter" data-level="7.1.2" data-path="oncoprint.html"><a href="oncoprint.html#define-the-alter-fun"><i class="fa fa-check"></i><b>7.1.2</b> Define the alter_fun()</a></li>
<li class="chapter" data-level="7.1.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-background"><i class="fa fa-check"></i><b>7.1.3</b> Background</a></li>
<li class="chapter" data-level="7.1.4" data-path="oncoprint.html"><a href="oncoprint.html#complex-alteration-types"><i class="fa fa-check"></i><b>7.1.4</b> Complex alteration types</a></li>
<li class="chapter" data-level="7.1.5" data-path="oncoprint.html"><a href="oncoprint.html#simplify-alter_fun"><i class="fa fa-check"></i><b>7.1.5</b> Simplify alter_fun</a></li>
<li class="chapter" data-level="7.1.6" data-path="oncoprint.html"><a href="oncoprint.html#other-heatmap-related-settings"><i class="fa fa-check"></i><b>7.1.6</b> Other heatmap-related settings</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="oncoprint.html"><a href="oncoprint.html#apply-to-cbioportal-dataset"><i class="fa fa-check"></i><b>7.2</b> Apply to cBioPortal dataset</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="oncoprint.html"><a href="oncoprint.html#remove-empty-rows-and-columns"><i class="fa fa-check"></i><b>7.2.1</b> Remove empty rows and columns</a></li>
<li class="chapter" data-level="7.2.2" data-path="oncoprint.html"><a href="oncoprint.html#reorder-the-oncoprint"><i class="fa fa-check"></i><b>7.2.2</b> Reorder the oncoPrint</a></li>
<li class="chapter" data-level="7.2.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-annotations"><i class="fa fa-check"></i><b>7.2.3</b> OncoPrint annotations</a></li>
<li class="chapter" data-level="7.2.4" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-as-a-heatmap"><i class="fa fa-check"></i><b>7.2.4</b> oncoPrint as a Heatmap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="upset-plot.html"><a href="upset-plot.html"><i class="fa fa-check"></i><b>8</b> UpSet plot</a>
<ul>
<li class="chapter" data-level="8.1" data-path="upset-plot.html"><a href="upset-plot.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
<li class="chapter" data-level="8.2" data-path="upset-plot.html"><a href="upset-plot.html#upset-mode"><i class="fa fa-check"></i><b>8.2</b> Mode</a></li>
<li class="chapter" data-level="8.3" data-path="upset-plot.html"><a href="upset-plot.html#make-the-combination-matrix"><i class="fa fa-check"></i><b>8.3</b> Make the combination matrix</a></li>
<li class="chapter" data-level="8.4" data-path="upset-plot.html"><a href="upset-plot.html#upset-utility-functions"><i class="fa fa-check"></i><b>8.4</b> Utility functions</a></li>
<li class="chapter" data-level="8.5" data-path="upset-plot.html"><a href="upset-plot.html#upset-making-the-plot"><i class="fa fa-check"></i><b>8.5</b> Make the plot</a></li>
<li class="chapter" data-level="8.6" data-path="upset-plot.html"><a href="upset-plot.html#upset-plots-as-heatmaps"><i class="fa fa-check"></i><b>8.6</b> UpSet plots as heatmaps</a></li>
<li class="chapter" data-level="8.7" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-movies-dataset"><i class="fa fa-check"></i><b>8.7</b> Example with the movies dataset</a></li>
<li class="chapter" data-level="8.8" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-genomic-regions"><i class="fa fa-check"></i><b>8.8</b> Example with the genomic regions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>9</b> Interactive ComplexHeatmap</a>
<ul>
<li class="chapter" data-level="9.1" data-path="interactive.html"><a href="interactive.html#on-the-interactive-graphics-device"><i class="fa fa-check"></i><b>9.1</b> On the interactive graphics device</a></li>
<li class="chapter" data-level="9.2" data-path="interactive.html"><a href="interactive.html#on-other-devices"><i class="fa fa-check"></i><b>9.2</b> On other devices</a></li>
<li class="chapter" data-level="9.3" data-path="interactive.html"><a href="interactive.html#shiny-app"><i class="fa fa-check"></i><b>9.3</b> Shiny app</a></li>
<li class="chapter" data-level="9.4" data-path="interactive.html"><a href="interactive.html#implement-a-shiny-app-from-scratch"><i class="fa fa-check"></i><b>9.4</b> Implement a Shiny app from scratch</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html"><i class="fa fa-check"></i><b>10</b> Integrate with other packages</a>
<ul>
<li class="chapter" data-level="10.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#pheatmap"><i class="fa fa-check"></i><b>10.1</b> pheatmap</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#examples"><i class="fa fa-check"></i><b>10.1.1</b> Examples</a></li>
<li class="chapter" data-level="10.1.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#translation"><i class="fa fa-check"></i><b>10.1.2</b> Translation</a></li>
<li class="chapter" data-level="10.1.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#comparisons"><i class="fa fa-check"></i><b>10.1.3</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#cowplot"><i class="fa fa-check"></i><b>10.2</b> cowplot</a></li>
<li class="chapter" data-level="10.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext"><i class="fa fa-check"></i><b>10.3</b> gridtext</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-title"><i class="fa fa-check"></i><b>10.3.1</b> Titles</a></li>
<li class="chapter" data-level="10.3.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-dimnames"><i class="fa fa-check"></i><b>10.3.2</b> Row/column names</a></li>
<li class="chapter" data-level="10.3.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-annotations"><i class="fa fa-check"></i><b>10.3.3</b> Annotation labels</a></li>
<li class="chapter" data-level="10.3.4" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-anno-text"><i class="fa fa-check"></i><b>10.3.4</b> Text annotation</a></li>
<li class="chapter" data-level="10.3.5" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-legends"><i class="fa fa-check"></i><b>10.3.5</b> Legend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html"><i class="fa fa-check"></i><b>11</b> Other High-level Plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#density-heatmap"><i class="fa fa-check"></i><b>11.1</b> Density heatmap</a></li>
<li class="chapter" data-level="11.2" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#stacked-summary-plot"><i class="fa fa-check"></i><b>11.2</b> Stacked summary plot</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="more-examples.html"><a href="more-examples.html"><i class="fa fa-check"></i><b>12</b> More Examples</a>
<ul>
<li class="chapter" data-level="12.1" data-path="more-examples.html"><a href="more-examples.html#add-more-information-for-gene-expression-matrix"><i class="fa fa-check"></i><b>12.1</b> Add more information for gene expression matrix</a></li>
<li class="chapter" data-level="12.2" data-path="more-examples.html"><a href="more-examples.html#the-measles-vaccine-heatmap"><i class="fa fa-check"></i><b>12.2</b> The measles vaccine heatmap</a></li>
<li class="chapter" data-level="12.3" data-path="more-examples.html"><a href="more-examples.html#visualize-cell-heterogeneity-from-single-cell-rnaseq"><i class="fa fa-check"></i><b>12.3</b> Visualize Cell Heterogeneity from Single Cell RNASeq</a></li>
<li class="chapter" data-level="12.4" data-path="more-examples.html"><a href="more-examples.html#correlations-between-methylation-expression-and-other-genomic-features"><i class="fa fa-check"></i><b>12.4</b> Correlations between methylation, expression and other genomic features</a></li>
<li class="chapter" data-level="12.5" data-path="more-examples.html"><a href="more-examples.html#visualize-methylation-profile-with-complex-annotations"><i class="fa fa-check"></i><b>12.5</b> Visualize Methylation Profile with Complex Annotations</a></li>
<li class="chapter" data-level="12.6" data-path="more-examples.html"><a href="more-examples.html#add-multiple-boxplots-for-single-row"><i class="fa fa-check"></i><b>12.6</b> Add multiple boxplots for single row</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="other-tricks.html"><a href="other-tricks.html"><i class="fa fa-check"></i><b>13</b> Other Tricks</a>
<ul>
<li class="chapter" data-level="13.1" data-path="other-tricks.html"><a href="other-tricks.html#set-the-same-cell-size-for-different-heatmaps-with-different-dimensions"><i class="fa fa-check"></i><b>13.1</b> Set the same cell size for different heatmaps with different dimensions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ComplexHeatmap Complete Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-list-of-heatmaps" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> A List of Heatmaps</h1>
<p>The main feature of <strong>ComplexHeatmap</strong> package is it supports to concatenate a
list of heatmaps and annotations horizontally or vertically so that it makes
it possible to visualize the associations from various sources of information.
In this chapter, we mainly introduce the horizontal concatenation because this
is the major case we will use in the analysis. In the end we show some
examples of vertical concatenation. The concept behind for horizontal and
vertical concatenation basically is similar.</p>
<p>For the horizontal concatenation, the number of rows for all heatmaps and
annotations should be the same. In following we first introduce the
concatenation of heatmaps and later we will show how to concatenate heatmaps
with annotations.</p>
<p>In following example, there are three matrices where the third heatmap is a
vector and it will be transformed as a one-column matrix. The one-column
heatmap is sometimes useful when you concatenate a list of heatmaps that it
can show e.g. annotations for each row or some scores of each row. E.g. if
rows are genes, the type of the genes (i.e. protein coding or not) can be
represented as a one-column character matrix, and the p-value or the fold
change from differential expression analysis can be represented as a
one-column numeric matrix, and be concatenated to the main expression heatmap.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="a-list-of-heatmaps.html#cb309-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb309-2"><a href="a-list-of-heatmaps.html#cb309-2"></a>mat1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">80</span>, <span class="dv">2</span>), <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb309-3"><a href="a-list-of-heatmaps.html#cb309-3"></a>mat1 =<span class="st"> </span><span class="kw">rbind</span>(mat1, <span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">40</span>, <span class="dv">-2</span>), <span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb309-4"><a href="a-list-of-heatmaps.html#cb309-4"></a><span class="kw">rownames</span>(mat1) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;R&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb309-5"><a href="a-list-of-heatmaps.html#cb309-5"></a><span class="kw">colnames</span>(mat1) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb309-6"><a href="a-list-of-heatmaps.html#cb309-6"></a></span>
<span id="cb309-7"><a href="a-list-of-heatmaps.html#cb309-7"></a>mat2 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">60</span>, <span class="dt">max =</span> <span class="dv">3</span>, <span class="dt">min =</span> <span class="dv">1</span>), <span class="dv">6</span>, <span class="dv">10</span>)</span>
<span id="cb309-8"><a href="a-list-of-heatmaps.html#cb309-8"></a>mat2 =<span class="st"> </span><span class="kw">rbind</span>(mat2, <span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">60</span>, <span class="dt">max =</span> <span class="dv">2</span>, <span class="dt">min =</span> <span class="dv">0</span>), <span class="dv">6</span>, <span class="dv">10</span>))</span>
<span id="cb309-9"><a href="a-list-of-heatmaps.html#cb309-9"></a><span class="kw">rownames</span>(mat2) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;R&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb309-10"><a href="a-list-of-heatmaps.html#cb309-10"></a><span class="kw">colnames</span>(mat2) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb309-11"><a href="a-list-of-heatmaps.html#cb309-11"></a></span>
<span id="cb309-12"><a href="a-list-of-heatmaps.html#cb309-12"></a>le =<span class="st"> </span><span class="kw">sample</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dv">12</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb309-13"><a href="a-list-of-heatmaps.html#cb309-13"></a><span class="kw">names</span>(le) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;R&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb309-14"><a href="a-list-of-heatmaps.html#cb309-14"></a></span>
<span id="cb309-15"><a href="a-list-of-heatmaps.html#cb309-15"></a>ind =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">12</span>, <span class="dv">12</span>)</span>
<span id="cb309-16"><a href="a-list-of-heatmaps.html#cb309-16"></a>mat1 =<span class="st"> </span>mat1[ind, ]</span>
<span id="cb309-17"><a href="a-list-of-heatmaps.html#cb309-17"></a>mat2 =<span class="st"> </span>mat2[ind, ]</span>
<span id="cb309-18"><a href="a-list-of-heatmaps.html#cb309-18"></a>le =<span class="st"> </span>le[ind]</span></code></pre></div>
<p>To concatenate heatmaps, simply use <code>+</code> operator.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="a-list-of-heatmaps.html#cb310-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>)</span>
<span id="cb310-2"><a href="a-list-of-heatmaps.html#cb310-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>)</span>
<span id="cb310-3"><a href="a-list-of-heatmaps.html#cb310-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>)</span>
<span id="cb310-4"><a href="a-list-of-heatmaps.html#cb310-4"></a></span>
<span id="cb310-5"><a href="a-list-of-heatmaps.html#cb310-5"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-2-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Under default mode, dendrograms from the second heatmap will be removed and
row orders will be the same as the first one. Also row names for the first two
heatmaps are removed as well.</p>
<p>The returned value of the concatenation is a <code>HeatmapList</code> object. Similar as
explained in Section <a href="a-single-heatmap.html#plot-the-heatmap">2.11</a>, directly printing <code>ht_list</code> will
call <code>draw()</code> method with default settings. With explicitly calling <code>draw()</code>
method, you can have more controls on the heatmap list.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="a-list-of-heatmaps.html#cb311-1"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb311-2"><a href="a-list-of-heatmaps.html#cb311-2"></a><span class="kw">class</span>(ht_list)</span></code></pre></div>
<pre><code>## [1] &quot;HeatmapList&quot;
## attr(,&quot;package&quot;)
## [1] &quot;ComplexHeatmap&quot;</code></pre>
<p>You can append any number of heatmaps to the heatmap list. Also you can append
a heatmap list to a heatmap list.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="a-list-of-heatmaps.html#cb313-1"></a><span class="co"># code only for demonstration</span></span>
<span id="cb313-2"><a href="a-list-of-heatmaps.html#cb313-2"></a>ht1 <span class="op">+</span><span class="st"> </span>ht_list</span>
<span id="cb313-3"><a href="a-list-of-heatmaps.html#cb313-3"></a>ht_list <span class="op">+</span><span class="st"> </span>ht1</span>
<span id="cb313-4"><a href="a-list-of-heatmaps.html#cb313-4"></a>ht_list <span class="op">+</span><span class="st"> </span>ht_list</span></code></pre></div>
<p><code>NULL</code> can be added to the heatmap list. It would be convinient when users
want to construct a heatmap list through a <code>for</code> loop.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="a-list-of-heatmaps.html#cb314-1"></a><span class="co"># code only for demonstration</span></span>
<span id="cb314-2"><a href="a-list-of-heatmaps.html#cb314-2"></a>ht_list =<span class="st"> </span><span class="ot">NULL</span>  <span class="co">## Heatmap(...) + NULL gives you a HeatmapList object</span></span>
<span id="cb314-3"><a href="a-list-of-heatmaps.html#cb314-3"></a><span class="cf">for</span>(s <span class="cf">in</span> sth) {</span>
<span id="cb314-4"><a href="a-list-of-heatmaps.html#cb314-4"></a>    ht_list =<span class="st"> </span>ht_list <span class="op">+</span><span class="st"> </span><span class="kw">Heatmap</span>(...)</span>
<span id="cb314-5"><a href="a-list-of-heatmaps.html#cb314-5"></a>}</span></code></pre></div>
<p>You can also add heatmap annotations to the heatmap list, see more details in
Section <a href="a-list-of-heatmaps.html#concatenate-with-annotations">4.7</a>.</p>
<div id="heatmap-list-titles" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Titles</h2>
<p>A heatmap list also has title which is like a global title covering all
heatmaps. <code>row_title</code> and <code>column_title</code> should be set in the <code>draw()</code>
function.</p>
<p>From following example, we set different colors for each heatmap to make them
distinguishable.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="a-list-of-heatmaps.html#cb315-1"></a>col_rnorm =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb315-2"><a href="a-list-of-heatmaps.html#cb315-2"></a>col_runif =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span>
<span id="cb315-3"><a href="a-list-of-heatmaps.html#cb315-3"></a>col_letters =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span> =<span class="st"> &quot;pink&quot;</span>, <span class="st">&quot;b&quot;</span> =<span class="st"> &quot;purple&quot;</span>, <span class="st">&quot;c&quot;</span> =<span class="st"> &quot;blue&quot;</span>)</span>
<span id="cb315-4"><a href="a-list-of-heatmaps.html#cb315-4"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm,</span>
<span id="cb315-5"><a href="a-list-of-heatmaps.html#cb315-5"></a>    <span class="dt">row_title =</span> <span class="st">&quot;Heatmap 1&quot;</span>, <span class="dt">column_title =</span> <span class="st">&quot;Heatmap 1&quot;</span>)</span>
<span id="cb315-6"><a href="a-list-of-heatmaps.html#cb315-6"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif,</span>
<span id="cb315-7"><a href="a-list-of-heatmaps.html#cb315-7"></a>    <span class="dt">row_title =</span> <span class="st">&quot;Heatmap 2&quot;</span>, <span class="dt">column_title =</span> <span class="st">&quot;Heatmap 2&quot;</span>)</span>
<span id="cb315-8"><a href="a-list-of-heatmaps.html#cb315-8"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb315-9"><a href="a-list-of-heatmaps.html#cb315-9"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb315-10"><a href="a-list-of-heatmaps.html#cb315-10"></a></span>
<span id="cb315-11"><a href="a-list-of-heatmaps.html#cb315-11"></a><span class="kw">draw</span>(ht_list, <span class="dt">row_title =</span> <span class="st">&quot;Three heatmaps, row title&quot;</span>, <span class="dt">row_title_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb315-12"><a href="a-list-of-heatmaps.html#cb315-12"></a>    <span class="dt">column_title =</span> <span class="st">&quot;Three heatmaps, column title&quot;</span>, <span class="dt">column_title_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">16</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_title-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>You can use <code>gt_render()</code> to construct complicated text, see Section <a href="integrate-with-other-packages.html#gridtext">10.3</a>.</p>
</div>
<div id="size-of-heatmaps" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Size of heatmaps</h2>
<p>The width for some heatmaps can be set to absolute units. Note <code>width</code>
controls the width of the heatmap body.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="a-list-of-heatmaps.html#cb316-1"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb316-2"><a href="a-list-of-heatmaps.html#cb316-2"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>))</span>
<span id="cb316-3"><a href="a-list-of-heatmaps.html#cb316-3"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_size-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The width of all heatmaps can be set as absolute units.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="a-list-of-heatmaps.html#cb317-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb317-2"><a href="a-list-of-heatmaps.html#cb317-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">6</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb317-3"><a href="a-list-of-heatmaps.html#cb317-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb317-4"><a href="a-list-of-heatmaps.html#cb317-4"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_relative_size-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>If <code>width</code> is numeric, it is converted as a <code>null</code> unit.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="a-list-of-heatmaps.html#cb318-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">width =</span> <span class="dv">6</span>)</span>
<span id="cb318-2"><a href="a-list-of-heatmaps.html#cb318-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">width =</span> <span class="dv">4</span>)</span>
<span id="cb318-3"><a href="a-list-of-heatmaps.html#cb318-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters, <span class="dt">width =</span> <span class="dv">1</span>)</span>
<span id="cb318-4"><a href="a-list-of-heatmaps.html#cb318-4"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;" /></p>
<p><code>heatmap_width</code> also can control the width of the heatmap, but it is the total
width of the heatmap body plus the heatmap components.</p>
</div>
<div id="gap-between-heatmaps" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Gap between heatmaps</h2>
<p><code>ht_gap</code> controls the space between heatmaps. The value can be a single unit
or a vector of units.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="a-list-of-heatmaps.html#cb319-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm)</span>
<span id="cb319-2"><a href="a-list-of-heatmaps.html#cb319-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb319-3"><a href="a-list-of-heatmaps.html#cb319-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb319-4"><a href="a-list-of-heatmaps.html#cb319-4"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb319-5"><a href="a-list-of-heatmaps.html#cb319-5"></a><span class="kw">draw</span>(ht_list, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_gap-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="a-list-of-heatmaps.html#cb320-1"></a><span class="kw">draw</span>(ht_list, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>), <span class="st">&quot;mm&quot;</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_gap-2.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="automatic-adjustment-to-the-main-heatmap" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Automatic adjustment to the main heatmap</h2>
<p>There is always a main heatmap in the heatmap list that controls the global
row ordering. All the other heatmaps are automatically adjusted according to
the settings in the main heatmap. For these non-main heatmaps, the adjustments
are:</p>
<ul>
<li>No row clustering is performed and they all take the row ordering of the
main heatmap.</li>
<li>Row titles are removed.</li>
<li>If the main heatmap is split by rows, all other heatmaps will also be split
by same levels as the main heatmap.</li>
<li>The height of the main heatmap are taken as the height of all heatmaps.</li>
</ul>
<p>By default, the first heatmap is taken as the main heatmap.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="a-list-of-heatmaps.html#cb321-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>)</span>
<span id="cb321-2"><a href="a-list-of-heatmaps.html#cb321-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb321-3"><a href="a-list-of-heatmaps.html#cb321-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb321-4"><a href="a-list-of-heatmaps.html#cb321-4"></a>ht2 <span class="op">+</span><span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht3 <span class="co"># ht2 is the main heatmap and row_km in ht1 is ignored</span></span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_auto_adjust-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The main heatmap can be specified by <code>main_heatmap</code> argument. The value can be
a numeric index or the name of the heatmap (of course, you need to set the
heatmap name when you create the <code>Heatmap</code> object). In following example,
although <code>ht1</code> is the second heatmap, we can set it as the main heatmap.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="a-list-of-heatmaps.html#cb322-1"></a>ht_list =<span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb322-2"><a href="a-list-of-heatmaps.html#cb322-2"></a><span class="kw">draw</span>(ht_list, <span class="dt">main_heatmap =</span> <span class="st">&quot;rnorm&quot;</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-7-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>By default, the dendrogram and the row title are plotted just beside the main
heatmap, just to emphasize the clustering or the splitting is calculated from
the main heatmap while not other heatmaps. However, the position of the
dendrogram and row title of the main heatmap can be controlled by
<code>row_dend_side</code> and <code>row_sub_title_side</code> in <code>draw()</code> function.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="a-list-of-heatmaps.html#cb323-1"></a>ht_list =<span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb323-2"><a href="a-list-of-heatmaps.html#cb323-2"></a><span class="kw">draw</span>(ht_list, <span class="dt">main_heatmap =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">row_dend_side =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">row_sub_title_side =</span> <span class="st">&quot;left&quot;</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Similarly, if there is no row clustering in the main heatmap, all other
heatmaps are not clustered neither.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="a-list-of-heatmaps.html#cb324-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>)</span>
<span id="cb324-2"><a href="a-list-of-heatmaps.html#cb324-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb324-3"><a href="a-list-of-heatmaps.html#cb324-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb324-4"><a href="a-list-of-heatmaps.html#cb324-4"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_auto_adjust_no_row_cluster-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>As you may have observed, all the row names between heatmaps are removed from
the plot. You can show them by setting <code>auto_adjust = FALSE</code>.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="a-list-of-heatmaps.html#cb325-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm)</span>
<span id="cb325-2"><a href="a-list-of-heatmaps.html#cb325-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb325-3"><a href="a-list-of-heatmaps.html#cb325-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb325-4"><a href="a-list-of-heatmaps.html#cb325-4"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb325-5"><a href="a-list-of-heatmaps.html#cb325-5"></a><span class="kw">draw</span>(ht_list, <span class="dt">auto_adjust =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-9-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="control-main-heatmap-in-draw-function" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Control main heatmap in draw() function</h2>
<p>Settings of the main heatmap can be controlled in the main <code>Heatmap()</code>
function. To make it convinient, settings that affect heatmap rows can also be
directly set in <code>draw()</code>. If some of these settings are set, corresponding
settings in the main <code>Heatmap()</code> will be overwritten.</p>
<p>In <code>draw()</code> function, following main heatmap settings control row orders of
all heatmaps.</p>
<ul>
<li><code>cluster_rows</code></li>
<li><code>clustering_distance_rows</code></li>
<li><code>clustering_method_rows</code></li>
<li><code>row_dend_width</code></li>
<li><code>show_row_dend</code></li>
<li><code>row_dend_reorder</code></li>
<li><code>row_dend_gp</code></li>
<li><code>row_order</code></li>
</ul>
<p>Following settings control the row slices.</p>
<ul>
<li><code>row_gap</code></li>
<li><code>row_km</code></li>
<li><code>row_km_repeats</code></li>
<li><code>row_split</code></li>
</ul>
<p>Following settings control the heatmap height.</p>
<ul>
<li><code>height</code></li>
<li><code>heatmap_height</code></li>
</ul>
<p>In following example, <code>row_km = 2, cluster_rows = FALSE</code> for <code>ht1</code> is
overwritten in <code>draw()</code>.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="a-list-of-heatmaps.html#cb326-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>, <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>)</span>
<span id="cb326-2"><a href="a-list-of-heatmaps.html#cb326-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb326-3"><a href="a-list-of-heatmaps.html#cb326-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb326-4"><a href="a-list-of-heatmaps.html#cb326-4"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb326-5"><a href="a-list-of-heatmaps.html#cb326-5"></a><span class="kw">draw</span>(ht_list, <span class="dt">row_km =</span> <span class="dv">1</span>, <span class="dt">row_split =</span> le, <span class="dt">cluster_rows =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-10-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="annotations-as-components-are-adjusted" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Annotations as components are adjusted</h2>
<p>If some of the heatmaps in the heatmap list have annotations, in most of the
cases, the heights of the heatmap annotations are different for different
heatmaps. There are automatic adjustment for heatmap annotations, and this
adjustment will also involve adjustment of dendrograms.</p>
<p>Normally, the size of simple annotations will not change in the adjustment. In
following example, the dendrogram for the second heatmap is adjusted. Note you
still can change the size of simple annotation by setting <code>anno_simple_size</code>
in <code>HeatmapAnnotation()</code> or globally set <code>ht_opt$anno_simple_size</code>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="a-list-of-heatmaps.html#cb327-1"></a>ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb327-2"><a href="a-list-of-heatmaps.html#cb327-2"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">top_annotation =</span> ha1)</span>
<span id="cb327-3"><a href="a-list-of-heatmaps.html#cb327-3"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb327-4"><a href="a-list-of-heatmaps.html#cb327-4"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb327-5"><a href="a-list-of-heatmaps.html#cb327-5"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If the first two heatmaps all have annotations, since the size of simple
annotations keep unchanged, the size of complex annotations will be adjusted
to make the total heights of the two heatmap annotations the same.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="a-list-of-heatmaps.html#cb328-1"></a>ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">bar1 =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), </span>
<span id="cb328-2"><a href="a-list-of-heatmaps.html#cb328-2"></a>    <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb328-3"><a href="a-list-of-heatmaps.html#cb328-3"></a>ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">bar2 =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</span>
<span id="cb328-4"><a href="a-list-of-heatmaps.html#cb328-4"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">top_annotation =</span> ha1)</span>
<span id="cb328-5"><a href="a-list-of-heatmaps.html#cb328-5"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">top_annotation =</span> ha2)</span>
<span id="cb328-6"><a href="a-list-of-heatmaps.html#cb328-6"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb328-7"><a href="a-list-of-heatmaps.html#cb328-7"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb328-8"><a href="a-list-of-heatmaps.html#cb328-8"></a><span class="kw">draw</span>(ht_list, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">2</span>), <span class="st">&quot;mm&quot;</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Similarly, if the first heatmap only contains simple annotatins, dendrogram
will be adjusted.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="a-list-of-heatmaps.html#cb329-1"></a>ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb329-2"><a href="a-list-of-heatmaps.html#cb329-2"></a>ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">bar2 =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb329-3"><a href="a-list-of-heatmaps.html#cb329-3"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">top_annotation =</span> ha1)</span>
<span id="cb329-4"><a href="a-list-of-heatmaps.html#cb329-4"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">top_annotation =</span> ha2)</span>
<span id="cb329-5"><a href="a-list-of-heatmaps.html#cb329-5"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb329-6"><a href="a-list-of-heatmaps.html#cb329-6"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb329-7"><a href="a-list-of-heatmaps.html#cb329-7"></a><span class="kw">draw</span>(ht_list, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">2</span>), <span class="st">&quot;mm&quot;</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>If the both heatmaps only contain simple annotations but with unequal number,
dendrogram will be adjusted.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="a-list-of-heatmaps.html#cb330-1"></a>ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb330-2"><a href="a-list-of-heatmaps.html#cb330-2"></a>ha2 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">bar2 =</span> <span class="kw">cbind</span>(<span class="dt">b1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">b2 =</span> <span class="dv">11</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">b3 =</span> <span class="dv">21</span><span class="op">:</span><span class="dv">30</span>))</span>
<span id="cb330-3"><a href="a-list-of-heatmaps.html#cb330-3"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">top_annotation =</span> ha1)</span>
<span id="cb330-4"><a href="a-list-of-heatmaps.html#cb330-4"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">top_annotation =</span> ha2)</span>
<span id="cb330-5"><a href="a-list-of-heatmaps.html#cb330-5"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb330-6"><a href="a-list-of-heatmaps.html#cb330-6"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb330-7"><a href="a-list-of-heatmaps.html#cb330-7"></a><span class="kw">draw</span>(ht_list)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-14-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>If you also want to automatically adjust the size of simple annotations, set
<code>simple_anno_size_adjust = TRUE</code> in every <code>HeatmapAnnotation()</code> calls.</p>
<p>If the second heatmap has no bottom annotation, column names for the second
heatmap are adjusted to be put directly below the heatmap body.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="a-list-of-heatmaps.html#cb331-1"></a>ha1 =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">bar1 =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb331-2"><a href="a-list-of-heatmaps.html#cb331-2"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">bottom_annotation =</span> ha1)</span>
<span id="cb331-3"><a href="a-list-of-heatmaps.html#cb331-3"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb331-4"><a href="a-list-of-heatmaps.html#cb331-4"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(le, <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb331-5"><a href="a-list-of-heatmaps.html#cb331-5"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ht3</span>
<span id="cb331-6"><a href="a-list-of-heatmaps.html#cb331-6"></a><span class="kw">draw</span>(ht_list)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-15-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="concatenate-with-annotations" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Concatenate with annotations</h2>
<p>Row annotations can be concatenated to the horizontal heatmap list, while not
only a component of the heatmap. See following examples which are very
straightforward.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="a-list-of-heatmaps.html#cb332-1"></a>ha1 =<span class="st"> </span><span class="kw">rowAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">bar =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb332-2"><a href="a-list-of-heatmaps.html#cb332-2"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>)</span>
<span id="cb332-3"><a href="a-list-of-heatmaps.html#cb332-3"></a>ht1 <span class="op">+</span><span class="st"> </span>ha1</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>foo</code> and <code>bar</code> annotations can be defined in two separated
<code>rowAnnotation()</code> calls.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="a-list-of-heatmaps.html#cb333-1"></a><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb333-2"><a href="a-list-of-heatmaps.html#cb333-2"></a><span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb333-3"><a href="a-list-of-heatmaps.html#cb333-3"></a><span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">bar =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You may wonder how to recover the row names of <code>mat1</code>. There are two ways.</p>
<ol style="list-style-type: decimal">
<li>you can set the row annotation as the “right annotation” of the heatmap and
put the heatmap as the last one.</li>
</ol>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="a-list-of-heatmaps.html#cb334-1"></a><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>, <span class="dt">right_annotation =</span> ha1)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="a-list-of-heatmaps.html#cb335-1"></a><span class="co"># or using the previous variable</span></span>
<span id="cb335-2"><a href="a-list-of-heatmaps.html#cb335-2"></a><span class="co"># attach_annotation(ht1, ha1, side = &quot;right&quot;)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>add the row names by adding a text annotation:</li>
</ol>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="a-list-of-heatmaps.html#cb336-1"></a>ht1 <span class="op">+</span><span class="st"> </span>ha1 <span class="op">+</span><span class="st"> </span><span class="kw">rowAnnotation</span>(<span class="dt">rn =</span> <span class="kw">anno_text</span>(<span class="kw">rownames</span>(mat1), </span>
<span id="cb336-2"><a href="a-list-of-heatmaps.html#cb336-2"></a>    <span class="dt">location =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;npc&quot;</span>), <span class="dt">just =</span> <span class="st">&quot;left&quot;</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Basically heatmaps and row annotations can be concatenated arbitarily.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="a-list-of-heatmaps.html#cb337-1"></a><span class="kw">rowAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb337-2"><a href="a-list-of-heatmaps.html#cb337-2"></a><span class="st">    </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb337-3"><a href="a-list-of-heatmaps.html#cb337-3"></a><span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">bar =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))) <span class="op">+</span></span>
<span id="cb337-4"><a href="a-list-of-heatmaps.html#cb337-4"></a><span class="st">    </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>As mentioned in previous chapters, row annotations can also be heatmap
components as left annotations or right annotations. The difference of row
annotations as independent ones and as heatmap components is discussed in
Section <a href="a-list-of-heatmaps.html#vertical-concatenation">4.9</a>.</p>
</div>
<div id="concatenate-only-the-annotations" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Concatenate only the annotations</h2>
<p>The concatenation can be done without any heatmap.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="a-list-of-heatmaps.html#cb338-1"></a><span class="kw">rowAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb338-2"><a href="a-list-of-heatmaps.html#cb338-2"></a><span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">bar =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If there is only one <code>HeatmapAnnotation</code> object, you must concatenated with <code>NULL</code>.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="a-list-of-heatmaps.html#cb339-1"></a><span class="kw">rowAnnotation</span>(<span class="dt">bar =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The annotation list is actually also a <code>HeatmapList</code> object.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="a-list-of-heatmaps.html#cb340-1"></a>anno_list =<span class="st"> </span><span class="kw">rowAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb340-2"><a href="a-list-of-heatmaps.html#cb340-2"></a><span class="st">    </span><span class="kw">rowAnnotation</span>(<span class="dt">bar =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb340-3"><a href="a-list-of-heatmaps.html#cb340-3"></a><span class="kw">class</span>(anno_list)</span></code></pre></div>
<pre><code>## [1] &quot;HeatmapList&quot;
## attr(,&quot;package&quot;)
## [1] &quot;ComplexHeatmap&quot;</code></pre>
<p>Thus, you can use some functionalities of the <code>draw()</code> function for the
annotation list, such as row splitting.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="a-list-of-heatmaps.html#cb342-1"></a><span class="kw">draw</span>(anno_list, <span class="dt">row_split =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dt">each =</span> <span class="dv">6</span>))</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In Section <a href="other-high-level-plots.html#stacked-summary-plot">11.2</a>, we will show how to use a list of
annotations to visualize multiple summary statistics.</p>
</div>
<div id="vertical-concatenation" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Vertical concatenation</h2>
<p>Heatmaps and annotations (now it is column annotation) can be concatenated
vertically by the <code>%v%</code> operator. All the relatated settings and adjustments
are very similar as the horizontal concatenation. Please check following
examples.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="a-list-of-heatmaps.html#cb343-1"></a>mat1t =<span class="st"> </span><span class="kw">t</span>(mat1)</span>
<span id="cb343-2"><a href="a-list-of-heatmaps.html#cb343-2"></a>mat2t =<span class="st"> </span><span class="kw">t</span>(mat2)</span>
<span id="cb343-3"><a href="a-list-of-heatmaps.html#cb343-3"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1t, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_title =</span> <span class="st">&quot;rnorm&quot;</span>)</span>
<span id="cb343-4"><a href="a-list-of-heatmaps.html#cb343-4"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2t, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">row_title =</span> <span class="st">&quot;runif&quot;</span>)</span>
<span id="cb343-5"><a href="a-list-of-heatmaps.html#cb343-5"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(<span class="kw">rbind</span>(<span class="dt">letters =</span> le), <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb343-6"><a href="a-list-of-heatmaps.html#cb343-6"></a>ht_list =<span class="st"> </span>ht1 <span class="op">%v%</span><span class="st"> </span>ht2 <span class="op">%v%</span><span class="st"> </span>ht3</span>
<span id="cb343-7"><a href="a-list-of-heatmaps.html#cb343-7"></a><span class="kw">draw</span>(ht_list)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-25-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="a-list-of-heatmaps.html#cb344-1"></a><span class="kw">draw</span>(ht_list, <span class="dt">column_km =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-25-2.png" width="499.2" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="a-list-of-heatmaps.html#cb345-1"></a>ha =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb345-2"><a href="a-list-of-heatmaps.html#cb345-2"></a>ht_list =<span class="st"> </span>ht1 <span class="op">%v%</span><span class="st"> </span>ha <span class="op">%v%</span><span class="st"> </span>ht2 <span class="op">%v%</span><span class="st"> </span>ht3</span>
<span id="cb345-3"><a href="a-list-of-heatmaps.html#cb345-3"></a><span class="kw">draw</span>(ht_list, <span class="dt">column_km =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-26-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="a-list-of-heatmaps.html#cb346-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1t, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>)</span>
<span id="cb346-2"><a href="a-list-of-heatmaps.html#cb346-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2t, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">row_km =</span> <span class="dv">2</span>)</span>
<span id="cb346-3"><a href="a-list-of-heatmaps.html#cb346-3"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(<span class="kw">rbind</span>(<span class="dt">letters =</span> le), <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb346-4"><a href="a-list-of-heatmaps.html#cb346-4"></a>ha =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb346-5"><a href="a-list-of-heatmaps.html#cb346-5"></a>ht_list =<span class="st"> </span>ht1 <span class="op">%v%</span><span class="st"> </span>ha <span class="op">%v%</span><span class="st"> </span>ht2 <span class="op">%v%</span><span class="st"> </span>ht3</span>
<span id="cb346-6"><a href="a-list-of-heatmaps.html#cb346-6"></a><span class="kw">draw</span>(ht_list, <span class="dt">column_km =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-27-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>For the vertical heatmap list, now row annotations should be the heatmap
components (by <code>right_annotation</code> and <code>left_annotation</code>) and they are adjusted
just like column annotations for the horizontal heatmap list.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="a-list-of-heatmaps.html#cb347-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1t, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, <span class="dt">row_km =</span> <span class="dv">2</span>,</span>
<span id="cb347-2"><a href="a-list-of-heatmaps.html#cb347-2"></a>    <span class="dt">left_annotation =</span> <span class="kw">rowAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">bar1 =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb347-3"><a href="a-list-of-heatmaps.html#cb347-3"></a>ha =<span class="st"> </span><span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb347-4"><a href="a-list-of-heatmaps.html#cb347-4"></a>    <span class="dt">axis_param =</span> <span class="kw">list</span>(<span class="dt">side =</span> <span class="st">&quot;right&quot;</span>)))</span>
<span id="cb347-5"><a href="a-list-of-heatmaps.html#cb347-5"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2t, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">row_km =</span> <span class="dv">2</span>,</span>
<span id="cb347-6"><a href="a-list-of-heatmaps.html#cb347-6"></a>    <span class="dt">left_annotation =</span> <span class="kw">rowAnnotation</span>(<span class="dt">foo2 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</span>
<span id="cb347-7"><a href="a-list-of-heatmaps.html#cb347-7"></a>ht3 =<span class="st"> </span><span class="kw">Heatmap</span>(<span class="kw">rbind</span>(<span class="dt">letters =</span> le), <span class="dt">name =</span> <span class="st">&quot;letters&quot;</span>, <span class="dt">col =</span> col_letters)</span>
<span id="cb347-8"><a href="a-list-of-heatmaps.html#cb347-8"></a>ht_list =<span class="st"> </span>ht1 <span class="op">%v%</span><span class="st"> </span>ha <span class="op">%v%</span><span class="st"> </span>ht2 <span class="op">%v%</span><span class="st"> </span>ht3</span>
<span id="cb347-9"><a href="a-list-of-heatmaps.html#cb347-9"></a><span class="kw">draw</span>(ht_list, <span class="dt">column_km =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-28-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>Since <code>rowAnnotation()</code> allows arbitary number of annotations, the way showed
above is the only way to expand the heatmap list horizontally and vertically
at the same time.</p>
</div>
<div id="subset-heatmap-list" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> Subset the heatmap list</h2>
<p>Similar as subsetting the <code>Heatmap</code> object (Section <a href="a-single-heatmap.html#subset-a-heatmap">2.13</a>),
the heatmap list can also be subsetted by providing row index and column
index. For horizontal heatmap list, row index correspond to rows in all
heatmaps and annotations, while column index only corresponds to a subset of
heatmaps and annotations. For vertical heatmap list, it’s the other way
around.</p>
<p>In following we use horizontal heatmap list as example.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="a-list-of-heatmaps.html#cb348-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm, </span>
<span id="cb348-2"><a href="a-list-of-heatmaps.html#cb348-2"></a>    <span class="dt">left_annotation =</span> <span class="kw">rowAnnotation</span>(<span class="dt">foo1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">bar1 =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)))</span>
<span id="cb348-3"><a href="a-list-of-heatmaps.html#cb348-3"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb348-4"><a href="a-list-of-heatmaps.html#cb348-4"></a>ha =<span class="st"> </span><span class="kw">rowAnnotation</span>(<span class="dt">foo2 =</span> <span class="kw">anno_barplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">bar2 =</span> <span class="dv">12</span><span class="op">:</span><span class="dv">1</span>)</span>
<span id="cb348-5"><a href="a-list-of-heatmaps.html#cb348-5"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2 <span class="op">+</span><span class="st"> </span>ha</span>
<span id="cb348-6"><a href="a-list-of-heatmaps.html#cb348-6"></a><span class="kw">names</span>(ht_list)</span></code></pre></div>
<pre><code>## [1] &quot;rnorm&quot; &quot;runif&quot; &quot;foo2&quot;  &quot;bar2&quot;</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="a-list-of-heatmaps.html#cb350-1"></a>ht_list[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="kw">c</span>(<span class="st">&quot;rnorm&quot;</span>, <span class="st">&quot;bar2&quot;</span>)]</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-29-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p><code>foo1</code> and <code>bar</code> are components of heatmap <code>rnorm</code>, so they can not be
selected in the subset function, while <code>foo2</code> and <code>bar2</code> are independent row
annotations and they can selected to take subset of them.</p>
</div>
<div id="plot-the-heamtap-list" class="section level2" number="4.11">
<h2><span class="header-section-number">4.11</span> Plot the heatmap list</h2>
<p>Similar as described in Section <a href="a-single-heatmap.html#plot-the-heatmap">2.11</a>, directly entering the
HeatmapList object in interactive R session calls the <code>show()</code> method which
calls the <code>draw()</code> method internally. When there is no plot after you entering
the object, you should use <code>draw()</code> explicitly:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="a-list-of-heatmaps.html#cb351-1"></a><span class="co"># code only for demonstration</span></span>
<span id="cb351-2"><a href="a-list-of-heatmaps.html#cb351-2"></a><span class="kw">draw</span>(ht_list, ...)</span></code></pre></div>
</div>
<div id="get-orders-and-dendrograms-from-a-list-of-heatmaps" class="section level2" number="4.12">
<h2><span class="header-section-number">4.12</span> Get orders and dendrograms</h2>
<p><code>row_order()</code>, <code>column_order()</code>, <code>row_dend()</code> and <code>column_dend()</code> can be used
to retrieve corresponding information from the heatmap list. The usage is
straightforward by following examples. But remember you need to apply these
functions on the object returned by <code>draw()</code>.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="a-list-of-heatmaps.html#cb352-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm)</span>
<span id="cb352-2"><a href="a-list-of-heatmaps.html#cb352-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif)</span>
<span id="cb352-3"><a href="a-list-of-heatmaps.html#cb352-3"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2</span>
<span id="cb352-4"><a href="a-list-of-heatmaps.html#cb352-4"></a>ht_list =<span class="st"> </span><span class="kw">draw</span>(ht_list)</span>
<span id="cb352-5"><a href="a-list-of-heatmaps.html#cb352-5"></a><span class="kw">row_order</span>(ht_list)</span></code></pre></div>
<pre><code>##  [1] 10  4  8  2  1 12 11  6  7  3  9  5</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="a-list-of-heatmaps.html#cb354-1"></a><span class="kw">column_order</span>(ht_list)</span></code></pre></div>
<pre><code>## $rnorm
##  [1]  5  2  7  6 10  1  9  8  4  3
## 
## $runif
##  [1]  4 10  2  5  7  6  1  3  8  9</code></pre>
<p>If rows or columns are split, the returned values will also be a list.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="a-list-of-heatmaps.html#cb356-1"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">col =</span> col_rnorm)</span>
<span id="cb356-2"><a href="a-list-of-heatmaps.html#cb356-2"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>, <span class="dt">col =</span> col_runif, <span class="dt">column_km =</span> <span class="dv">2</span>)</span>
<span id="cb356-3"><a href="a-list-of-heatmaps.html#cb356-3"></a>ht_list =<span class="st"> </span>ht1 <span class="op">+</span><span class="st"> </span>ht2</span>
<span id="cb356-4"><a href="a-list-of-heatmaps.html#cb356-4"></a>ht_list =<span class="st"> </span><span class="kw">draw</span>(ht_list, <span class="dt">row_km =</span> <span class="dv">2</span>)</span>
<span id="cb356-5"><a href="a-list-of-heatmaps.html#cb356-5"></a><span class="kw">row_order</span>(ht_list)</span></code></pre></div>
<pre><code>## $`1`
## [1] 7 3 9 5
## 
## $`2`
## [1] 10  4  8  2  1 12 11  6</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="a-list-of-heatmaps.html#cb358-1"></a><span class="kw">column_order</span>(ht_list)</span></code></pre></div>
<pre><code>## $rnorm
## $rnorm[[1]]
##  [1]  5  2  7  6 10  1  9  8  4  3
## 
## 
## $runif
## $runif$`2`
## [1]  4 10  2  5
## 
## $runif$`1`
## [1] 7 6 1 3 8 9</code></pre>
<p>You can specify a certain heatmap for the column order.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="a-list-of-heatmaps.html#cb360-1"></a><span class="kw">column_order</span>(ht_list, <span class="dt">name =</span> <span class="st">&quot;runif&quot;</span>)</span></code></pre></div>
<pre><code>## $`2`
## [1]  4 10  2  5
## 
## $`1`
## [1] 7 6 1 3 8 9</code></pre>
<p>The logic is the same for extracting dendrograms and also the same for vertical
heatmap list, so we don’t show more examples here.</p>
</div>
<div id="change-parameters-globally" class="section level2" number="4.13">
<h2><span class="header-section-number">4.13</span> Change parameters globally</h2>
<p><code>ht_opt()</code> is an option function which controls some parameters globally. You
can set some parameters for all heatmaps/annotations simultaneously by this
global function. Please note you should put it before your heatmap code and
reset all option values after drawing the heatmaps to get rid of affecting
next heatmap.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="a-list-of-heatmaps.html#cb362-1"></a>ht_opt</span></code></pre></div>
<pre><code>##  Option                    Value             
##  -------------------------:--------------------
##  heatmap_row_names_gp      NULL              
##  heatmap_column_names_gp   NULL              
##  heatmap_row_title_gp      NULL              
##  heatmap_column_title_gp   NULL              
##  legend_title_gp           NULL              
##  legend_title_position     NULL              
##  legend_labels_gp          NULL              
##  legend_grid_height        NULL              
##  legend_grid_width         NULL              
##  legend_border             NULL              
##  legend_gap                4mm, 4mm          
##  heatmap_border            NULL              
##  annotation_border         NULL              
##  fast_hclust               FALSE             
##  show_parent_dend_line     TRUE              
##  verbose                   FALSE             
##  message                   TRUE              
##  show_vp                   FALSE             
##  simple_anno_size          5mm               
##  DENDROGRAM_PADDING        0.5mm             
##  DIMNAME_PADDING           1mm               
##  TITLE_PADDING             8.5points, 0points
##  COLUMN_ANNO_PADDING       1mm               
##  ROW_ANNO_PADDING          1mm               
##  HEATMAP_LEGEND_PADDING    2mm               
##  ANNOTATION_LEGEND_PADDING 2mm</code></pre>
<p>There are following parameters to control all heatmaps:</p>
<ul>
<li><code>heatmap_row_names_gp</code>: set <code>row_names_gp</code> in all <code>Heatmap()</code>.</li>
<li><code>heatmap_column_names_gp</code>: set <code>column_names_gp</code> in all <code>Heatmap()</code>.</li>
<li><code>heatmap_row_title_gp</code>: set <code>row_title_gp</code> in all <code>Heatmap()</code>.</li>
<li><code>heatmap_column_title_gp</code>: set <code>column_title_gp</code> in all <code>Heatmap()</code>.</li>
<li><code>heatmap_border</code>: set <code>border</code> in all <code>Heatmap()</code>.</li>
</ul>
<p>Following parameters control the legends:</p>
<ul>
<li><code>legend_title_gp</code>: set <code>title_gp</code> in all heatmap legends and annotation
legends.</li>
<li><code>legend_title_position</code>: set <code>title_position</code> in all heatmap legends and
annotation legends.</li>
<li><code>legend_labels_gp</code>: set <code>labels_gp</code> in all heatmap legends and annotation
legends.</li>
<li><code>legend_grid_width</code>: set <code>grid_width</code> in all heatmap legends and annotation
legends.</li>
<li><code>legend_grid_height</code>: set <code>grid_height</code> in all heatmap legends and
annotation legends.</li>
<li><code>legend_border</code>: set <code>border</code> in all heatmap legends and annotation legends.</li>
</ul>
<p>Following parameters control heatmap annotations:</p>
<ul>
<li><code>annotation_border</code>: set <code>border</code> in all <code>HeatmapAnnotation()</code>.</li>
<li><code>anno_simple_size</code>: set size for the simple annotation.</li>
</ul>
<p>Following parameters control the space between heatmap components:</p>
<ul>
<li><code>DENDROGRAM_PADDING</code>: space bewteen dendrograms and heatmap body.</li>
<li><code>DIMNAME_PADDING</code>: space between row/column names and heatmap body.</li>
<li><code>TITLE_PADDING</code>: space between row/column titles and heatmap body.</li>
<li><code>COLUMN_ANNO_PADDING</code>: space between column annotations and heatmap body.</li>
<li><code>ROW_ANNO_PADDING</code>: space between row annotations and heatmap body.</li>
</ul>
<p>Other parameters:</p>
<ul>
<li><code>fast_hclust</code>: whether use <code>fastcluster::hclust()</code> to speed up clustering?</li>
<li><code>show_parent_dend_line</code>: when heatmap is split, whether to add a dashed line
to mark parent dendrogram and children dendrograms?</li>
</ul>
<p>You can get or set option values by the traditional way (like
<code>base::options()</code>) or by <code>$</code> operator:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="a-list-of-heatmaps.html#cb364-1"></a><span class="kw">ht_opt</span>(<span class="st">&quot;heatmap_row_names_gp&quot;</span>)</span>
<span id="cb364-2"><a href="a-list-of-heatmaps.html#cb364-2"></a>ht_opt<span class="op">$</span>heatmap_row_names_gp</span>
<span id="cb364-3"><a href="a-list-of-heatmaps.html#cb364-3"></a></span>
<span id="cb364-4"><a href="a-list-of-heatmaps.html#cb364-4"></a><span class="co"># to set option values</span></span>
<span id="cb364-5"><a href="a-list-of-heatmaps.html#cb364-5"></a><span class="kw">ht_opt</span>(<span class="st">&quot;heatmap_row_names_gp&quot;</span> =<span class="st"> </span><span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">8</span>))</span>
<span id="cb364-6"><a href="a-list-of-heatmaps.html#cb364-6"></a>ht_opt<span class="op">$</span>heatmap_row_names_gp =<span class="st"> </span><span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">8</span>)</span></code></pre></div>
<p>Reset to the default values by:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="a-list-of-heatmaps.html#cb365-1"></a><span class="kw">ht_opt</span>(<span class="dt">RESET =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Following example shows to control some graphic parameters globally.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="a-list-of-heatmaps.html#cb366-1"></a><span class="kw">ht_opt</span>(<span class="dt">heatmap_column_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontface =</span> <span class="st">&quot;italic&quot;</span>), </span>
<span id="cb366-2"><a href="a-list-of-heatmaps.html#cb366-2"></a>    <span class="dt">heatmap_column_title_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">10</span>),</span>
<span id="cb366-3"><a href="a-list-of-heatmaps.html#cb366-3"></a>    <span class="dt">legend_border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb366-4"><a href="a-list-of-heatmaps.html#cb366-4"></a>    <span class="dt">heatmap_border =</span> <span class="ot">TRUE</span>,</span>
<span id="cb366-5"><a href="a-list-of-heatmaps.html#cb366-5"></a>    <span class="dt">annotation_border =</span> <span class="ot">TRUE</span></span>
<span id="cb366-6"><a href="a-list-of-heatmaps.html#cb366-6"></a>)</span>
<span id="cb366-7"><a href="a-list-of-heatmaps.html#cb366-7"></a>ht1 =<span class="st"> </span><span class="kw">Heatmap</span>(mat1, <span class="dt">name =</span> <span class="st">&quot;ht1&quot;</span>, <span class="dt">column_title =</span> <span class="st">&quot;Heatmap 1&quot;</span>,</span>
<span id="cb366-8"><a href="a-list-of-heatmaps.html#cb366-8"></a>    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</span>
<span id="cb366-9"><a href="a-list-of-heatmaps.html#cb366-9"></a>ht2 =<span class="st"> </span><span class="kw">Heatmap</span>(mat2, <span class="dt">name =</span> <span class="st">&quot;ht2&quot;</span>, <span class="dt">column_title =</span> <span class="st">&quot;Heatmap 2&quot;</span>,</span>
<span id="cb366-10"><a href="a-list-of-heatmaps.html#cb366-10"></a>    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">bar =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</span>
<span id="cb366-11"><a href="a-list-of-heatmaps.html#cb366-11"></a>ht1 <span class="op">+</span><span class="st"> </span>ht2</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-37-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="a-list-of-heatmaps.html#cb367-1"></a><span class="kw">ht_opt</span>(<span class="dt">RESET =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>These global parameters can also be set in the <code>draw()</code> function to
temporarily change the global parameters, and they are reset back after the
plot is made. Please check the help page of <code>draw,HeatmapList-method</code>.</p>
</div>
<div id="adjust-blank-space-caused-by-annotations" class="section level2" number="4.14">
<h2><span class="header-section-number">4.14</span> Adjust blank space caused by annotations</h2>
<p>Heatmap annotations may have annotation names and axes, for which the spaces
are also taken into account when arranging heatmap components in the final
layout. Sometimes, this adjustment is not smart that you may see blank areas
in the plot that are not necessary.</p>
<p>One scenario is for a matrix with no row names, the space to the right of the
heatmap is determined by the size of annotation name, which results in blank
space between the heatmap and the legend. Also the heatmap list level row
title is plotted to the left of the annotation axis, which gives blank area if
there is no row dendrogram.</p>
<p><code>adjust_annotation_extension</code> controls whether to take account of the space of
annotation names and axes for the layout. Compare following two plots.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="a-list-of-heatmaps.html#cb368-1"></a>m =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)</span>
<span id="cb368-2"><a href="a-list-of-heatmaps.html#cb368-2"></a>ht =<span class="st"> </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>,</span>
<span id="cb368-3"><a href="a-list-of-heatmaps.html#cb368-3"></a>    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)),</span>
<span id="cb368-4"><a href="a-list-of-heatmaps.html#cb368-4"></a>    <span class="dt">show_row_dend =</span> <span class="ot">FALSE</span>)</span>
<span id="cb368-5"><a href="a-list-of-heatmaps.html#cb368-5"></a><span class="kw">draw</span>(ht, <span class="dt">row_title =</span> <span class="st">&quot;fooooooooooo&quot;</span>, <span class="dt">adjust_annotation_extension =</span> <span class="ot">TRUE</span>,  <span class="co"># default</span></span>
<span id="cb368-6"><a href="a-list-of-heatmaps.html#cb368-6"></a>    <span class="dt">column_title =</span> <span class="st">&quot;adjust_annotation_extension = TRUE&quot;</span>)</span>
<span id="cb368-7"><a href="a-list-of-heatmaps.html#cb368-7"></a><span class="kw">draw</span>(ht, <span class="dt">row_title =</span> <span class="st">&quot;fooooooooooo&quot;</span>, <span class="dt">adjust_annotation_extension =</span> <span class="ot">FALSE</span>,</span>
<span id="cb368-8"><a href="a-list-of-heatmaps.html#cb368-8"></a>    <span class="dt">column_title =</span> <span class="st">&quot;adjust_annotation_extension = FALSE&quot;</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-39-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Another way to partially solve the space problem is to move the annotation name
to the left and use heamtap-level row title.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="a-list-of-heatmaps.html#cb369-1"></a><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>,</span>
<span id="cb369-2"><a href="a-list-of-heatmaps.html#cb369-2"></a>    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>),</span>
<span id="cb369-3"><a href="a-list-of-heatmaps.html#cb369-3"></a>        <span class="dt">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>),</span>
<span id="cb369-4"><a href="a-list-of-heatmaps.html#cb369-4"></a>    <span class="dt">row_title =</span> <span class="st">&quot;fooooooooooo&quot;</span>,</span>
<span id="cb369-5"><a href="a-list-of-heatmaps.html#cb369-5"></a>    <span class="dt">show_row_dend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>However, this adjustment for annotations sometimes is also necessary, e.g. when the heatmap is
very short:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="a-list-of-heatmaps.html#cb370-1"></a>ht =<span class="st"> </span><span class="kw">Heatmap</span>(m, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>,</span>
<span id="cb370-2"><a href="a-list-of-heatmaps.html#cb370-2"></a>    <span class="dt">top_annotation =</span> <span class="kw">HeatmapAnnotation</span>(<span class="dt">foo =</span> <span class="kw">anno_points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)),</span>
<span id="cb370-3"><a href="a-list-of-heatmaps.html#cb370-3"></a>    <span class="dt">show_row_dend =</span> <span class="ot">FALSE</span>)</span>
<span id="cb370-4"><a href="a-list-of-heatmaps.html#cb370-4"></a><span class="kw">draw</span>(ht, <span class="dt">row_title =</span> <span class="st">&quot;fooooooooooo&quot;</span>, <span class="dt">adjust_annotation_extension =</span> <span class="ot">TRUE</span>,</span>
<span id="cb370-5"><a href="a-list-of-heatmaps.html#cb370-5"></a>    <span class="dt">column_title =</span> <span class="st">&quot;adjust_annotation_extension = TRUE&quot;</span>)</span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Therefore, we set <code>TRUE</code> as the default of <code>adjust_annotation_extension</code> and users can configure
it based on specific scenarios.</p>
</div>
<div id="manually-increase-space-around-the-plot" class="section level2" number="4.15">
<h2><span class="header-section-number">4.15</span> Manually increase space around the plot</h2>
<p>The layout of the <strong>ComplexHeatmap</strong> is not perfect that it is still possible some of the text are
drawn out of the plotting region. In this case, you can manually set the <code>padding</code> argument in <code>draw()</code> function
to increase the blank areas around the final plot.</p>
<p>The value of <code>padding</code> should be a unit vector with length of four. The four values correspond to the space at
the bottom, left, top and right sides.</p>
<p>The following example is not a perfect example because the maximal width for row names can be controlled
by <code>max_row_name_width</code> argument, but we can still use it to demonstrate the use of <code>padding</code>.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="a-list-of-heatmaps.html#cb371-1"></a>m2 =<span class="st"> </span>m</span>
<span id="cb371-2"><a href="a-list-of-heatmaps.html#cb371-2"></a><span class="kw">rownames</span>(m2) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;R&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb371-3"><a href="a-list-of-heatmaps.html#cb371-3"></a><span class="kw">rownames</span>(m2)[<span class="dv">1</span>] =<span class="st"> &quot;a long long long long long row name&quot;</span></span>
<span id="cb371-4"><a href="a-list-of-heatmaps.html#cb371-4"></a>ht =<span class="st"> </span><span class="kw">Heatmap</span>(m2, <span class="dt">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="dt">row_names_side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">show_row_dend =</span> <span class="ot">FALSE</span>)</span>
<span id="cb371-5"><a href="a-list-of-heatmaps.html#cb371-5"></a><span class="kw">draw</span>(ht, <span class="dt">padding =</span> <span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="st">&quot;mm&quot;</span>)) <span class="co">## see right heatmap in following</span></span></code></pre></div>
<p><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-43-1.png" width="960" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="heatmap-annotations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="legends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/ComplexHeatmap-reference/edit/master/04-a_list_of_heatmaps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
